<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>在线Excel转JSON工具</title>
    <meta name="description" content="在当今数据驱动的时代，Excel表格和JSON格式是两种最常用的数据载体。为了帮助用户高效完成数据转换，我们开发了这款完全免费的在线Excel转JSON工具，让数据格式转换变得简单快捷。" />
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <div class="container">
        <header>
            <h1>在线Excel转JSON工具</h1>
            <p class="subtitle">快速将Excel或CSV文件转换为JSON格式，支持数据预览、列选择、格式化和下载功能</p>
            <div id="ad_line" style="text-align: center; margin: auto; margin-top: 10px;"></div>
        </header>

        <div class="tool-container">
            <div class="input-section">
                <div class="card">
                    <h2 class="card-title">📤 输入文件</h2>

                    <div id="fileUploadArea" class="file-upload-area">
                        <div class="file-upload-icon">📁</div>
                        <h3>拖放文件到此处或点击上传</h3>
                        <p>支持 .xlsx 和 .csv 文件格式</p>
                        <p><small>(CSV文件需为UTF-8编码)</small></p>
                        <input type="file" id="fileInput" accept=".xlsx,.csv" style="display: none;">
                    </div>

                    <div id="fileInfo" class="file-info">
                        <strong>已选择文件:</strong> <span id="fileName"></span>
                        <span id="fileSize"></span>
                    </div>

                    <div id="columnsContainer" class="columns-container">
                        <h3>选择要转换的列 (默认全选):</h3>
                        <div id="columnsGrid" class="columns-grid">
                            <!-- 列选择器将在这里动态生成 -->
                        </div>
                    </div>

                    <div id="uploadStatus" class="status-message"></div>

                    <div class="action-buttons">
                        <button id="convertBtn" class="btn btn-primary" disabled>转换为JSON</button>
                        <button id="clearBtn" class="btn btn-warning">清空所有</button>
                    </div>
                </div>
            </div>

            <div class="output-section">
                <div class="card">
                    <h2 class="card-title">📥 输出结果</h2>

                    <textarea id="jsonOutput" placeholder="转换后的JSON数据将显示在这里..." readonly></textarea>

                    <div class="output-actions">
                        <button id="formatBtn" class="btn btn-utility" disabled>
                            <span>✨</span> 格式化
                        </button>
                        <button id="compressBtn" class="btn btn-utility" disabled>
                            <span>🔍</span> 压缩
                        </button>
                        <button id="downloadBtn" class="btn btn-secondary" disabled>
                            <span>💾</span> 下载JSON
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="instructions">
            <h2>📝 使用说明</h2>
            <div class="instructions-content">
                <div class="instruction-card">
                    <h3><span>ℹ️</span> 工具简介</h3>
                    <p>在线Excel转JSON工具，打开Excel或者CSV文件，转换为JSON格式的数据，转换后的JSON数据支持复制和下载。</p>
                </div>

                <div class="instruction-card">
                    <h3><span>📋</span> 文件要求</h3>
                    <ul>
                        <li>支持.xlsx和.csv文件格式</li>
                        <li>CSV文件需使用UTF-8编码</li>
                        <li>第一行为列名(不支持多行多列组合列名)</li>
                        <li>第二行开始为数据内容</li>
                    </ul>
                </div>

                <div class="instruction-card">
                    <h3><span>⚙️</span> 功能说明</h3>
                    <ul>
                        <li><strong>打开：</strong>上传Excel或CSV文件</li>
                        <li><strong>转换：</strong>将表格数据转换为JSON格式</li>
                        <li><strong>列选择：</strong>选择要包含在JSON中的列</li>
                        <li><strong>格式化：</strong>美化JSON输出格式</li>
                        <li><strong>压缩：</strong>压缩JSON为单行格式</li>
                        <li><strong>下载：</strong>将JSON保存为本地文件</li>
                        <li><strong>清空：</strong>重置所有数据</li>
                    </ul>
                </div>
            </div>
        </div>

        <footer>
            <p>© 2025 在线Excel转JSON工具 | 数据在浏览器本地处理，不会上传到服务器</p>
        </footer>
    </div>
</body>
</html>
