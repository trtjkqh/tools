<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>报价单</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
  @media print { .no-print { display: none; } }

  table th, table td { vertical-align: top; text-align: center; }
  thead th { background-color: #3b82f6; color: white; font-weight: bold; border-bottom: 2px solid #1e3a8a; }
  tbody tr:nth-child(even) { background-color: #f3f4f6; }

  table { border-collapse: separate; border-spacing: 0; box-shadow: 0 2px 4px rgba(0,0,0,0.05); border-radius: 0.5rem; overflow: hidden; }
  td, th { border-right: 1px solid #e5e7eb; border-bottom: 1px solid #e5e7eb; }
  th:last-child, td:last-child { border-right: none; }

  .buyer-info { background-color: #dbeafe; padding: 1rem; border-radius: 0.5rem; }
  .requirement-box { background-color: #f3f4f6; padding: 0.75rem; border-radius: 0.5rem; flex: 1; }
  .title-container { display: flex; align-items: center; gap: 0.75rem; justify-content: space-between; }
  .title-container img { width: 50px; height: 50px; object-fit: contain; }

  .requirement-line span { display: block; border-bottom: 1px solid #000; margin-bottom: 0.5rem; padding-left: 0.25rem; min-width: 50px; }
  .requirement-line span[contenteditable="true"] { background-color: #fff; }

  .stamp-area { width: 150px; height: 80px; border: 2px dashed #000; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #555; margin-left: 1rem; flex-shrink: 0; }
  .footer-note { border-top: 1px solid #e5e7eb; padding-top: 0.5rem; color: #555; font-size: 0.875rem; margin-top: 1rem; }
  .quote-date { text-align: right; margin-top: 0.5rem; font-weight: bold; }

  .export-btn, .add-btn, .add-ladder-btn, .delete-ladder-btn {
    background-color: #3b82f6;
    color: white;
    padding: 0.25rem 0.5rem;
    border-radius: 0.25rem;
    font-size: 0.75rem;
    cursor: pointer;
    margin: 2px;
  }
  .export-btn:hover, .add-btn:hover, .add-ladder-btn:hover, .delete-ladder-btn:hover { background-color: #2563eb; }
  td[contenteditable="true"] { background-color: #fefce8; }
</style>
</head>
<body class="p-6 bg-gray-50">

<!-- 顶部固定信息 -->
<div class="mb-6 border-b pb-4 buyer-info">
  <div class="title-container mb-4">
    <div class="flex items-center gap-2">
      <img src="assets/img/trtlogo.png" alt="公司Logo">
      <h1 class="text-2xl font-bold text-blue-800">报价单</h1>
    </div>
    <div>
      <button class="export-btn" onclick="exportToExcel()">导出为 Excel</button>
    </div>
  </div>
  <div class="grid grid-cols-2 gap-4">
    <div>
      <p><strong>需方（固定）:</strong> 北京同仁堂健康药业（青海）有限公司</p>
      <p><strong>联系人:</strong> 王维</p>
      <p><strong>联系电话:</strong> 18094719236</p>
      <p><strong>地址:</strong> 青海省海西州德令哈市同堂路1号</p>
    </div>
    <div>
      <p><strong>供方:</strong> _______________________</p>
      <p><strong>联系人:</strong> _______________________</p>
      <p><strong>联系电话:</strong> _______________________</p>
      <p><strong>地址:</strong> _______________________</p>
    </div>
  </div>
</div>

<!-- 新增产品按钮 -->
<div class="mb-2">
  <button class="add-btn" onclick="addProduct()">新增产品</button>
</div>

<!-- 报价表格 -->
<table id="quote-table" class="min-w-full bg-white mb-6">
  <thead>
    <tr>
      <th class="p-2">序号</th>
      <th class="p-2">产品名</th>
      <th class="p-2">规格</th>
      <th class="p-2">工艺</th>
      <th class="p-2">阶梯数量</th>
      <th class="p-2">阶梯单价</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="p-2">1</td>
      <td class="p-2" contenteditable="true">示例产品</td>
      <td class="p-2" contenteditable="true">规格</td>
      <td class="p-2" contenteditable="true">工艺</td>
      <td class="p-2">
        <div contenteditable="true">100</div>
        <div contenteditable="true">200</div>
        <div contenteditable="true">300</div>
        <div contenteditable="true">400</div>
      </td>
      <td class="p-2">
        <div contenteditable="true">¥50</div>
        <div contenteditable="true">¥45</div>
        <div contenteditable="true">¥40</div>
        <div contenteditable="true">¥35</div>
      </td>
    </tr>
  </tbody>
</table>

<!-- 报价要求 + 盖章区 -->
<div class="flex items-start mb-1">
  <div class="requirement-box">
    <h2 class="font-bold mb-2 text-gray-800">报价要求</h2>
    <div class="requirement-line">
      <span contenteditable="true">报价:</span>
      <span contenteditable="true">交期:</span>
      <span contenteditable="true">付款方式:</span>
      <span contenteditable="true">质量保证:</span>
      <span contenteditable="true">运输:</span>
      <span contenteditable="true">包装:</span>
    </div>
  </div>
  <div class="stamp-area">盖章区</div>
</div>

<div class="quote-date">报价日期: 2025-11-05</div>

<div class="footer-note">
  注：以上报价为示例，请根据实际情况填写。
</div>

<script>
  function addProduct() {
    const tbody = document.querySelector("#quote-table tbody");
    const rowCount = tbody.rows.length;
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td class="p-2">${rowCount + 1}</td>
      <td class="p-2" contenteditable="true">新产品</td>
      <td class="p-2" contenteditable="true">规格</td>
      <td class="p-2" contenteditable="true">工艺</td>
      <td class="p-2">
        <div contenteditable="true"></div>
        <div contenteditable="true"></div>
        <div contenteditable="true"></div>
        <div contenteditable="true"></div>
      </td>
      <td class="p-2">
        <div contenteditable="true"></div>
        <div contenteditable="true"></div>
        <div contenteditable="true"></div>
        <div contenteditable="true"></div>
      </td>
    `;
    tbody.appendChild(tr);
  }

  function exportToExcel() {
    const table = document.getElementById("quote-table");
    const wb = XLSX.utils.table_to_book(table, {sheet:"报价单"});
    XLSX.writeFile(wb, "报价单.xlsx");
  }
</script>
</body>
</html>